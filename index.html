<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <form onsubmit="savetoLocal(event)">
        <label>Name</label>
        <input id='name' type="text" name="username" required />
        <label> Email</label>
        <input id="mail" type="email" name="emailId" required />
        <label>password</label>
        <input id="pass" type="password" name="pass" />
        <button> submit</button>
    </form>

    <ul id="listofUsers"></ul>
    <script>
        function savetoLocal(event) {
            event.preventDefault();
            const username = event.target.username.value;
            const email = event.target.emailId.value;
            const password = event.target.pass.value;

            const obj = {
                username,
                email,
                password
            }

            localStorage.setItem(obj.email, JSON.stringify(obj));
            showMeUser(obj);

        }

        window.addEventListener("DOMContentLoaded", () => {
            const localStorageOBJ = localStorage;
            const localStoragekeys = Object.keys(localStorageOBJ);
            for (var i = 0; i < localStoragekeys.length; i++) {
                const key = localStoragekeys[i];
                const userDetails = localStorageOBJ[key];
                const userDetailObj = JSON.parse(userDetails);
                showMeUser(userDetailObj);

            }
        })

        function showMeUser(obj) {
            document.getElementById('mail').value = '';
            document.getElementById('name').value = '';
            document.getElementById('pass').value = '';
            if (localStorage.getItem(obj.email) !== null) {
                removeFromScreen(obj.email);
            }

            const parentNode = document.getElementById('listofUsers');
            const childNode = `<li id=${obj.email}> ${obj.username} - ${obj.email}  
                <button onclick=deleteUser('${obj.email}')> Delete User </button>
                <button onclick=editUser('${obj.email}','${obj.username}','${obj.password}')> Edit </button>
                  </li>`;
            parentNode.innerHTML = parentNode.innerHTML + childNode;
        }
        function deleteUser(emailId) {
            console.log(emailId)
            localStorage.removeItem(emailId);
            removeFromScreen(emailId);

        }
        function editUser(emai, user, word) {
            document.getElementById('mail').value = emai;
            document.getElementById('name').value = user;
            document.getElementById('pass').value = word;
            deleteUser(emai);
            removeFromScreen(emai);

        }

        function removeFromScreen(emailId, userDetail) {
            const parent = document.getElementById('listofUsers');
            const childtobeDeleted = document.getElementById(emailId);
            if (childtobeDeleted) {
                parent.removeChild(childtobeDeleted);
            }

        }
    </script>
</body>

</html>